language: scala
sudo: false
cache:
  directories:
    - $HOME/.ivy2

# There's no nicer way to specify this matrix; see
# https://github.com/travis-ci/travis-ci/issues/1519.
# Spark 1.5.0 only supports Java 7+.
matrix:
  include:
    # We only test Spark 1.4.1 with Hadooop 2.2.0 because
    # https://github.com/apache/spark/pull/6599 is not present in 1.4.1,
    # so the published Spark Maven artifacts will not work with Hadoop 1.x.
    #- jdk: openjdk6
    #  scala: 2.10.5
    #  env: HADOOP_VERSION="2.2.0" SPARK_VERSION="1.4.1"
    #- jdk: openjdk7
    #  scala: 2.10.5
    #  env: HADOOP_VERSION="1.0.4" SPARK_VERSION="1.5.0"
    
    #- jdk: openjdk7
    #  scala: 2.10.5
    #  env: HADOOP_VERSION="1.2.1" SPARK_VERSION="1.5.0"
    #- jdk: openjdk7
    #  scala: 2.10.5
    #  env: HADOOP_VERSION="2.2.0" SPARK_VERSION="1.5.0"
    ## Scala 2.11 tests:
    #- jdk: openjdk7
    #  scala: 2.11.7
    #  env: HADOOP_VERSION="2.2.0" SPARK_VERSION="1.5.0"
    #- jdk: openjdk7
    #  scala: 2.11.7
    #  env: HADOOP_VERSION="2.2.0" SPARK_VERSION="1.6.2" 
    - jdk: openjdk7
      scala: 2.11.7
      env: HADOOP_VERSION="2.2.0" SPARK_VERSION="1.6.2" INTEGRATION_TESTS="true"

env:
  global:
    # IT_SNOWFLAKE_CONF_BASE64
    - secure: "VVWpdN1BQ3kj+HkX7cST1d/KKiZt3VsElZrB/xkqC+jrDXjpREjj4aV7hLw8lUx9HcCLhSgNzK8yamV7prJ3Zl40BIRNvlCVq8n39qLrU3c09JEYsV0qjUZHUCzmVRc5C6Z+XXPuMDX1G37GQQ1DHL5LaNam0ae+q2/drVkEZA96abfzXanJy3AvvQQ6ED9AMmRERdkn9Lhny7upb40kzDrXNliPfaQ67hOrK7C864wYBW1tBk1indlGlDquHOtck9AhRc0wWsa7cUoY5SBvvnWPI20/rj9kPXa43RZl+A2mbe8bfxmpMg9Yj95p/26JcxdMqcIJZsdKraADI6UIZlSh/C3Hqs9uUuhDsmiw1DCYpX8OIvAY8rJQAxsg9/8ayA00X4J7z+KUcdKnwATrCuLwBqrOBO9Tr+oIflUzTtEBLjZvmlrifrYP0OSRKjZHKjdf9ZHbiBmdjBMj+q7Q9JmnyqY3QpXJ2YVStIhnGcCooi1rp9H7q26T7CS/3aSf4itJ4IjKeXN5dMqPO/7Iqi9DT7xE03rCKt4Cdd6JnTlrJ/eimG+qWjHx6qpZ8Y3gxp5OprZX+6rExEdx5m9CJ6fwHiftE8D0sbItIhNnrCyEy1dtQ+k8umThasXdy7IQvCJ+Pkqvo0AEYWJwxOYAldfz4W7eek7MvwJniQzEpic="

script:
   - echo $IT_SNOWFLAKE_CONF_BASE64
   - echo $IT_SNOWFLAKE_CONF_BASE64 | base64 -d
#  - if [ "$INTEGRATION_TESTS" != "true" ] ; then sbt -Dhadoop.testVersion=$HADOOP_VERSION -Dspark.testVersion=$SPARK_VERSION ++$TRAVIS_SCALA_VERSION coverage test ; fi
  - if [ "$TRAVIS_SECURE_ENV_VARS" == "true" -a "$INTEGRATION_TESTS" == "true" ]; then sbt -Dhadoop.version=$HADOOP_VERSION -Dspark.version=$SPARK_VERSION ++$TRAVIS_SCALA_VERSION coverage it:test ; fi
#  - sbt ++$TRAVIS_SCALA_VERSION scalastyle
#  - sbt ++$TRAVIS_SCALA_VERSION "test:scalastyle"
#  - sbt ++$TRAVIS_SCALA_VERSION  "it:scalastyle"

after_success:
  - bash <(curl -s https://codecov.io/bash)
